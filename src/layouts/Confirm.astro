---
import ConfirmForm from "@components/ConfirmForm.astro";
import ConfirmedGuestInfo from "@components/ConfirmedGuestInfo.astro";
import { getGuest } from "@domain/Guest";
import { onIntersect, show, translate } from "@utils";
export interface Props {
	id: string;
}

const guest = await getGuest(Astro.props.id);

if (!guest) {
	throw new Error("Invitado no encontrado");
}
---

<style is:global>
  @keyframes fade-in {
    from {
      opacity: 0;
    }
  }

  @keyframes fade-out {
    to {
      opacity: 0;
    }
  }

  @keyframes slide-from-bottom {
    from {
      transform: translateY(50px);
    }
  }

  #confirm {
    view-transition-name: confirm;
  }

  ::view-transition-old(confirm) {
    animation: 180ms cubic-bezier(0.4, 0, 1, 1) both fade-out;
  }
  ::view-transition-new(confirm) {
    animation:
      500ms cubic-bezier(0, 0, 0.2, 1) 90ms both fade-in,
      600ms cubic-bezier(0.4, 0, 0.2, 1) both slide-from-bottom;
  }
</style>


<div class="flex flex-col justify-center items-center w-full mt-20 my-10 px-4">
  <h3 class="text-center mb-10">
    <span
      class="block text-lg mb-5 transition-all ease-out duration-700 opacity-0 translate-x-[50%]"
      {...onIntersect(show(translate()))}
    >
      Invitaci√≥n para:
    </span>
    <span
      class="block text-5xl font-hand text-sky-950 transition-all ease-out duration-700 opacity-0 translate-x-[-50%]"
      {...onIntersect(show(translate()))}
    >
      {guest.name}
    </span>
  </h3>
  <div
    class="bg-white p-6 shadow-md rounded-md w-full max-w-screen-sm mx-10"
  >
    <div id="confirm">
      {guest.hasAnswered() ? (
        <ConfirmedGuestInfo guest={guest} />
      ) : (
        <ConfirmForm guest={guest} />
      )}
    </div>
  </div>
</div>
