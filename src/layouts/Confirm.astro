---
import ConfirmForm from "@components/ConfirmForm.astro";
import ConfirmedGuestInfo from "@components/ConfirmedGuestInfo.astro";
import { getGuest } from "@domain/Guest";
export interface Props {
	id: string;
}

const guest = await getGuest(Astro.props.id);
---

<style is:global>
  @keyframes fade-in {
    from {
      opacity: 0;
    }
  }

  @keyframes fade-out {
    to {
      opacity: 0;
    }
  }

  @keyframes slide-from-bottom {
    from {
      transform: translateY(50px);
    }
  }

  #confirm {
    view-transition-name: confirm;
  }

  ::view-transition-old(confirm) {
    animation: 180ms cubic-bezier(0.4, 0, 1, 1) both fade-out;
  }
  ::view-transition-new(confirm) {
    animation:
      500ms cubic-bezier(0, 0, 0.2, 1) 90ms both fade-in,
      600ms cubic-bezier(0.4, 0, 0.2, 1) both slide-from-bottom;
  }
</style>

{
  guest && (
    <div class="flex flex-col justify-center items-center w-full relative -top-9">
      <h2 class="mb-4">
        <>
          <span class="block mb-1">
            Nos complace invitarte.
          </span>
          <span class="block mb-1">
            a ser parte de este gran día
          </span>
        </>
      </h2>
      <h3 class="text-center mb-6">
        <span
          x-bind:class="shown ? 'translate-x-0 opacity-1' : 'opacity-0 translate-x-[50%]'"
          class="block text-[40px] font-hand transition-all ease-in-out duration-700"
        >
          Invitación para:
        </span>
        <span
          x-bind:class="shown ? 'translate-x-0 opacity-1' : 'opacity-0 translate-x-[-50%]'"
          class="block text-5xl font-hand transition-all ease-in-out duration-700"
        >
          {guest.name}
        </span>
      </h3>
      <div
        x-bind:class="shown ? 'opacity-1' : 'opacity-0'"
        class="bg-white p-6 shadow-md rounded-md w-full max-w-screen-md transition-all ease-in-out delay-100 duration-700"
      >
        <div id="confirm">
          {guest.hasAnswered() ? (
            <ConfirmedGuestInfo guest={guest} />
          ) : (
            <ConfirmForm guest={guest} />
          )}
        </div>
      </div>
    </div>
  )
}
